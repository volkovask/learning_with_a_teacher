## Проект: Обучение с учителем: качество модели.
### Описание проекта.
Интернет-магазин «В один клик» продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты.<br/>
Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться. Привлекать новых клиентов уже не так эффективно: о магазине и так знает большая часть целевой аудитории.<br/>
Возможный выход — удерживать активность постоянных клиентов. Сделать это можно с помощью персонализированных предложений.<br/>
«В один клик» — современная компания, поэтому её руководство не хочет принимать решения просто так — только на основе анализа данных и бизнес-моделирования.<br/>
У компании есть небольшой отдел цифровых технологий, и нам предстоит побыть в роли стажёра в этом отделе.<br/>
Отделу поручили разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.<br/>
<br/>
Продумывать подход к решению этой задачи нам не придётся — руководитель отдела его уже сформировал:
- Нужно промаркировать уровень финансовой активности постоянных покупателей. В компании принято выделять два уровня активности: «снизилась», если клиент стал покупать меньше товаров, и «прежний уровень».
- Нужно собрать данные по клиентам по следующим группам:
- Признаки, которые описывают коммуникацию сотрудников компании с клиентом.
- Признаки, которые описывают продуктовое поведение покупателя. Например, какие товары покупает и как часто.
- Признаки, которые описывают покупательское поведение клиента. Например, сколько тратил в магазине.
- Признаки, которые описывают поведение покупателя на сайте. Например, как много страниц просматривает и сколько времени проводит на сайте.<br/>
Представим группы признаков (вместе с целевым) в виде диаграммы — такую визуализацию ещё называют диаграммой Исикавы.<br/>
![image](https://github.com/user-attachments/assets/d8591775-479c-4342-8bf9-4bb242f88679)
<br/>
Решать задачу будем в два этапа:<br/>
- Разработаем модель, которая предскажет вероятность снижения покупательской активности.
- Выделим сегмент покупателей, проанализируем его и предложим, как увеличить его покупательскую активность. Используя данные моделирования, данные о прибыли покупателей и исходные данные (если понадобятся). По желанию можем проанализировать больше одного сегмента.<br/>
	
Ниже несколько примеров сегментов, также можем выделить свой:
	
- Группа клиентов с максимальной долей покупок по акции и высокой вероятностью снижения покупательской активности.
- Группа клиентов, которые покупают только технику, то есть товары с длинным жизненным циклом.
- Группа клиентов, которые покупают товары из категории «Товары для себя» (новая категория, которую можно выделить на основе текущих) или «Товары для детей».
- Группа клиентов с высокой вероятностью снижения покупательской активности и наиболее высокой прибыльностью.<br/>
### Описание данных.
Будем работать с четырьмя датасетами: данные о поведении покупателя на сайте, данные о выручке, данные о времени (в минутах), данные о среднемесячной прибыли продавца за последние 3 месяца.<br/><br/>
**Данные о поведении покупателя на сайте, о коммуникациях с покупателем и его продуктовом поведении.** — market_file.csv
- id — номер покупателя в корпоративной базе данных.
- Покупательская активность — рассчитанный класс покупательской активности (целевой признак): «снизилась» или «прежний уровень».
- Тип сервиса — уровень сервиса, например «премиум» и «стандарт».
- Разрешить сообщать — информация о том, можно ли присылать покупателю дополнительные предложения о товаре. Согласие на это даёт покупатель.
- Маркет_актив_6_мес — среднемесячное значение маркетинговых коммуникаций компании, которое приходилось на покупателя за последние 6 месяцев. Это значение показывает, какое число рассылок, звонков, показов рекламы и прочего приходилось на клиента.
- Маркет_актив_тек_мес — количество маркетинговых коммуникаций в текущем месяце.
- Длительность — значение, которое показывает, сколько дней прошло с момента регистрации покупателя на сайте.
- Акционные_покупки — среднемесячная доля покупок по акции от общего числа покупок за последние 6 месяцев.
- Популярная_категория — самая популярная категория товаров у покупателя за последние 6 месяцев.
- Средний_просмотр_категорий_за_визит — показывает, сколько в среднем категорий покупатель просмотрел за визит в течение последнего месяца.
- Неоплаченные_продукты_штук_квартал — общее число неоплаченных товаров в корзине за последние 3 месяца.
- Ошибка_сервиса — число сбоев, которые коснулись покупателя во время посещения сайта.
- Страниц_за_визит — среднее количество страниц, которые просмотрел покупатель за один визит на сайт за последние 3 месяца.<br/><br/>

**Данные о выручке, которую получает магазин с покупателя, то есть сколько покупатель всего потратил за период взаимодействия с сайтом.** — market_money.csv
- id — номер покупателя в корпоративной базе данных.
- Период — название периода, во время которого зафиксирована выручка. Например, 'текущий_месяц' или 'предыдущий_месяц'.
- Выручка — сумма выручки за период.<br/><br/>

**Данные о времени (в минутах), которое покупатель провёл на сайте в течение периода** — market_time.csv
- id — номер покупателя в корпоративной базе данных.
- Период — название периода, во время которого зафиксировано общее время.
- минут — значение времени, проведённого на сайте, в минутах.<br/><br/>

**Данные о среднемесячной прибыли продавца за последние 3 месяца: какую прибыль получает магазин от продаж каждому покупателю.** — money.csv
- id — номер покупателя в корпоративной базе данных.
- Прибыль — значение прибыли.<br/>
### Предварительный план.
**Первичный план проекта обучение с учителем: качество модели.**

* 1. Считать CSV-файлы ( market_file.csv, market_money, market_time.csv, money.csv) с данными с помощью библиотеки pandas и сохраните их в датафреймы. Вывести несколько случайных строк каждого набора и изучить общую информацию о каждом датафрейме.
* 2. Выполнить предобработку данных. Привести столбцы к единому формату. Проверить наличие пропусков и дубликатов в датафреймах. Обработать их, если такие значения присутствуют.
* 3. Провести исследовательский анализ данных. Отобрать клиентов с покупательской активностью не менее трёх месяцев, то есть таких, которые что-либо покупали в этот период. Оформите выводы по результатам шага. Построить графики для каждого признака. Сделать выводы о данных, есть ли выбросы, необычное распределение количественных признаков или другие особенности.
* 4. Объединить таблицы. Учитывать, что данные о выручке и времени на сайте находятся в одном столбце для всех периодов. В итоговой таблице необходимо сделать отдельный столбец для каждого периода.
* 5. Провести корреляционный анализ признаков в датафрейме market. Сделать выводы о мультиколлинеарности и при необходимости устранить её.
* 6. Использование пайплайнов. Во время подготовки данных использовать ColumnTransformer. Обучить четыре модели: KNeighborsClassifier(), DecisionTreeClassifier(), LogisticRegression() и  SVC(). Для каждой из них подобрать как минимум один гиперпараметр. Выбрать подходящую для задачи метрику, аргументировать свой выбор. Использовать эту метрику при подборе гиперпараметров. Выбрать лучшую модель, используя заданную метрику.
* 7. Оценить важность признаков для лучшей модели и построить график важности с помощью метода SHAP. Сделайть выводы о значимости признаков.
* 8. Выполнить сегментацию покупателей. Использовать результаты моделирования и данные о прибыльности покупателей. Выбрать группу покупателей и предложить, как увеличить её покупательскую активность. Сделайть выводы о сегментах.
* 9. Написать общий вывод.<br/>

**Базовая цель проекта.**

Разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.<br/>
Необходимо построить модель, которая предскажет вероятность снижения покупательской активности клиента в следующие три месяца.<br/>
В исследование нужно включить дополнительные данные финансового департамента о прибыльности клиента: какой доход каждый покупатель приносил компании за последние три месяца.<br/>
Используя данные модели и данные о прибыльности клиентов, нужно выделить сегменты покупателей и разработать для них персонализированные предложения.
